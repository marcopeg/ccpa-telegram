# Plan: Rename ccpa-telegram → telegrapp

## Overview

Rename the project from `ccpa-telegram` to `telegrapp` for npm publishing as `npx telegrapp`. This involves:
- Renaming the npm package and bin entry
- Moving config files from the top-level CWD into a `.telegrapp/` subdirectory
- Replacing all `.ccpa/` directory references with `.telegrapp/`
- Updating all user-facing strings and docs

---

## Phase 1: package.json

**Step 1.1** — Update `name` field: `"ccpa-telegram"` → `"telegrapp"`
**Step 1.2** — Update `bin` key: `"ccpa-telegram"` → `"telegrapp"`

---

## Phase 2: src/config.ts — Path constants

**Step 2.1** — `resolveDataDir` (line 169): `.ccpa` → `.telegrapp`
```
resolve(projectCwd, ".ccpa", "users")  →  resolve(projectCwd, ".telegrapp", "users")
resolve(configDir, ".ccpa", slug, "data")  →  resolve(configDir, ".telegrapp", slug, "data")
```

**Step 2.2** — `resolveProjectConfig` logDir (line 193): `.ccpa` → `.telegrapp`
```
resolve(configDir, ".ccpa", slug, "logs")  →  resolve(configDir, ".telegrapp", slug, "logs")
```

**Step 2.3** — `loadLocalConfig` (line 402): update filename and path
```
join(configDir, "ccpa.config.local.json")  →  join(configDir, ".telegrapp", "config.local.json")
```
Also update all error message strings referencing `ccpa.config.local.json` → `config.local.json`.

**Step 2.4** — `loadMultiConfig` (lines 485–493): update config filenames and paths
```
join(configDir, "ccpa.config.json")         →  join(configDir, ".telegrapp", "config.json")
join(configDir, "ccpa.config.local.json")   →  join(configDir, ".telegrapp", "config.local.json")
```
Also update all error message strings:
- `ccpa.config.json` → `.telegrapp/config.json`
- `ccpa.config.local.json` → `.telegrapp/config.local.json`
- `npx ccpa-telegram init` → `npx telegrapp init`

**Step 2.5** — `mergeLocalIntoBase` (lines 463–464): update error message
```
"ccpa.config.json"       →  ".telegrapp/config.json"
"ccpa.config.local.json" →  ".telegrapp/config.local.json"
```

---

## Phase 3: src/cli.ts — Help text, init command, source detection

**Step 3.1** — `showHelp()` (lines 63–98): replace all occurrences
- `ccpa-telegram` → `telegrapp`
- `ccpa.config.json` → `.telegrapp/config.json`
- `--cwd <path>    Directory containing ccpa.config.json` → `Directory containing .telegrapp/config.json`
- `Configuration (ccpa.config.json):` → `Configuration (.telegrapp/config.json):`

**Step 3.2** — `runInit()` (lines 129–147): update path, create `.telegrapp/` dir
- Change `configPath = join(cwd, "ccpa.config.json")` → `join(cwd, ".telegrapp", "config.json")`
- Add `await mkdir(join(cwd, ".telegrapp"), { recursive: true })` before writing
- Update `existsSync` check to match new path
- Update all `console.log`/`console.error` strings:
  - `ccpa.config.json` → `.telegrapp/config.json`
  - `npx ccpa-telegram` → `npx telegrapp`

**Step 3.3** — `runStart()` source-line detection (line 171):
```
f.endsWith("ccpa.config.local.json")  →  f.endsWith("config.local.json")
```
> Note: `config.local.json` is also a suffix of `config.local.json`, so this check remains semantically correct.

---

## Phase 4: src/bot.ts — Error string

**Step 4.1** — Line 29: update config file reference in error message
```
"ccpa.config.json"  →  ".telegrapp/config.json"
```

---

## Phase 5: src/context/resolver.ts — Hook paths

**Step 5.1** — Lines 231, 238: `.ccpa` → `.telegrapp` in both hook path lookups
```
join(configDir, ".ccpa", "hooks", "context.mjs")   →  join(configDir, ".telegrapp", "hooks", "context.mjs")
join(projectCwd, ".ccpa", "hooks", "context.mjs")  →  join(projectCwd, ".telegrapp", "hooks", "context.mjs")
```

---

## Phase 6: src/bot/commands/ — Command paths

**Step 6.1** — `watcher.ts` lines 25–26: `.ccpa` → `.telegrapp`
```
join(projectCwd, ".ccpa", "commands")  →  join(projectCwd, ".telegrapp", "commands")
join(configDir, ".ccpa", "commands")   →  join(configDir, ".telegrapp", "commands")
```

**Step 6.2** — `loader.ts` lines 18, 22: `.ccpa` → `.telegrapp`
```
join(projectCwd, ".ccpa", "commands")  →  join(projectCwd, ".telegrapp", "commands")
join(configDir, ".ccpa", "commands")   →  join(configDir, ".telegrapp", "commands")
```

**Step 6.3** — `loader.ts` line 214 comment: `.ccpa/commands` → `.telegrapp/commands`

---

## Phase 7: examples/ — File renames

**Step 7.1** — Rename `examples/ccpa.config.json` → `examples/telegrapp.config.json`
**Step 7.2** — Rename `examples/ccpa.config.local.json` → `examples/telegrapp.config.local.json`

---

## Phase 8: README.md — Documentation

**Step 8.1** — Title: `# ccpa-telegram` → `# telegrapp`

**Step 8.2** — All `ccpa-telegram` occurrences → `telegrapp`
Affected lines: title, quick start, installation, CLI commands section

**Step 8.3** — All `npx ccpa-telegram` → `npx telegrapp`

**Step 8.4** — Config filename references:
- `ccpa.config.json` → `.telegrapp/config.json`
- `ccpa.config.local.json` → `.telegrapp/config.local.json`

**Step 8.5** — All `.ccpa/` directory references → `.telegrapp/`
Affected sections: Context Injection, Custom Commands, Directory Structure, `dataDir` table, Log Files, Skills

**Step 8.6** — Directory structure diagram: update all paths and filenames

**Step 8.7** — `dataDir` table: update default value
```
`<project-cwd>/.ccpa/users`     →  `<project-cwd>/.telegrapp/users`
`<config-dir>/.ccpa/<slug>/data` →  `<config-dir>/.telegrapp/<slug>/data`
```

**Step 8.8** — Log Files section:
```
<config-dir>/.ccpa/<project-slug>/logs/  →  <config-dir>/.telegrapp/<project-slug>/logs/
```

**Step 8.9** — `projectCtx.config.configDir` description: `ccpa.config.json` → `.telegrapp/config.json`

**Step 8.10** — Example file links that reference `.ccpa/commands` → `.telegrapp/commands`

---

## Phase 9: CLAUDE.md — Project instructions

**Step 9.1** — Update title and references to reflect new naming:
- `ccpa.config.json` → `.telegrapp/config.json`
- `.ccpa/users/{userId}/` → `.telegrapp/users/{userId}/`

---

## Execution Order

1. Phase 1 (package.json) — isolated, no deps
2. Phase 2 (config.ts) — core path logic
3. Phase 3 (cli.ts) — depends on new config paths
4. Phase 4 (bot.ts) — string only
5. Phase 5 (context/resolver.ts) — path only
6. Phase 6 (bot/commands/) — path only
7. Phase 7 (examples/) — file renames
8. Phase 8 (README.md) — docs
9. Phase 9 (CLAUDE.md) — project instructions

Phases 1–6 can be executed in any order internally; they don't depend on each other.

---

## Verification Checklist

After implementation, verify:
- [ ] `grep -r "ccpa-telegram" src/ package.json README.md` returns no results
- [ ] `grep -r '"\.ccpa"' src/` returns no results (literal string `.ccpa`)
- [ ] `grep -r "ccpa\.config" src/ README.md` returns no results
- [ ] `pnpm run build` succeeds (TypeScript compiles cleanly)
- [ ] `pnpm run lint` passes (Biome finds no issues)
