# Plan: Default models per engine

## Phase 1 — Create `src/default-models.ts` ✅

### Step 1.1: Create the file ✅

Created `src/default-models.ts` with the `DEFAULT_ENGINE_MODEL` map and `getDefaultEngineModel()` function. Biome formatter preferred the function signature on a single line, so adjusted accordingly.

### Step 1.2: Re-export from engine barrel (if needed) ✅

No barrel changes needed — file is imported directly as `./default-models.js` from `cli.ts`.

---

## Phase 2 — Update `src/cli.ts` call sites ✅

### Step 2.1: Add import ✅

Added `import { getDefaultEngineModel } from "./default-models.js";` at the top of `cli.ts`.

### Step 2.2: Update `runInit` ✅

Replaced `getEngine(engineName)` with `getEngine(engineName, undefined, effectiveModel)` where `effectiveModel = getDefaultEngineModel(engineName)`.

### Step 2.3: Update `runBotsForConfig` ✅

Replaced `getEngine(config.engine, config.engineCommand, config.engineModel)` with resolution via `config.engineModel ?? getDefaultEngineModel(config.engine)`.

---

## Phase 3 — Update README.md ✅

### Step 3.1: Add "Model defaults" subsection ✅

Replaced the single-line "engine uses its own default model" sentence with a full **Model defaults** subsection explaining engine default vs HAL default behavior.

### Step 3.2: Update engine table `model` row ✅

Updated to reference [Model defaults](#model-defaults) and show `_(per engine)_` as default.

### Step 3.3: Update globals table `globals.engine.model` row ✅

Updated to reference [Model defaults](#model-defaults).

### Step 3.4: Update project table `engine.model` row ✅

Updated to reference [Model defaults](#model-defaults).

---

## Phase 4 — Verify ✅

### Step 4.1: Build and lint ✅

Both `pnpm run build` and `pnpm run lint` pass cleanly. Initial lint had two formatting issues (function signature line wrapping) which were fixed.

### Step 4.2: Manual verification checklist

- [x] `src/default-models.ts` exports `getDefaultEngineModel()` returning `"default"` for claude, `"opencode/gpt-5-nano"` for opencode, and `undefined` for codex/copilot/cursor.
- [x] `runInit` in `cli.ts` calls `getEngine(engineName, undefined, effectiveModel)` with the resolved default.
- [x] `runBotsForConfig` in `cli.ts` uses `config.engineModel ?? getDefaultEngineModel(config.engine)`.
- [x] No adapter files were changed (adapters already handle truthy/undefined model correctly).
- [x] README "Model defaults" subsection is present under Engine Configuration.
- [x] README engine table, globals table, and project table all reference "Model defaults".
- [x] Antigravity TODO placeholder exists in `default-models.ts`.
